<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  
  
  <mapper namespace="kr.co.jhta.soop.dao.ProjectTaskMemberDAO">
  
	<!-- 내가 참여한 프로젝트 가져오기 -->  
  	<select id="myproject_Select_task" resultType="kr.co.jhta.soop.dto.ProjectTaskMemberDTO" parameterType="int">
		<!-- SELECT p.project_no, p.project_title, t.project_no, t.task_no, t.member_no, t.task_title, t.task_status,m.member_no,m.name -->  
		SELECT *
		FROM project p
		JOIN task t
		ON p.project_no = t.project_no
		JOIN member m
		ON t.member_no = m.member_no
		WHERE m.member_no = #{m.member_no}
		AND t.task_title != ''
		AND t.task_content != ''; 
  	</select>
  	
  	<!-- 프로젝트별로 업무 가져오기  -->
  	<select id="TasksByProject" resultType="kr.co.jhta.soop.dto.ProjectTaskMemberDTO" parameterType="int">
  		SELECT p.project_no, p.project_title,t.task_no,t.task_title, m.member_no, m.name
		FROM project p
		JOIN task t
		ON p.project_no = t.project_no
		JOIN member m
		ON t.member_no = m.member_no
		WHERE m.member_no = #{member_no}
        AND p.project_no = #{project_no}
		AND t.task_title != ''
		AND t.task_content != '';  	
  	</select>
  	 
  	<!-- 드래그앤 드랍으로 업무상태값 변경시 업데이트  --> 	
  	<update id="myprojectUpdateTaskStatus" parameterType="kr.co.jhta.soop.dto.ProjectTaskMemberDTO">
  		UPDATE task t
  		JOIN member m
  		ON t.member_no = m.member_no
  		SET t.task_status = #{task_status}
  		WHERE m.member_no = #{member_no}
  		AND t.task_no = #{task_no}  	
  	</update>
  </mapper>